<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>LV12 Shop | تحميل...</title>
<link rel="icon" href="/lv12.png" />
<link rel="image_src" href="https://www.lv12shop.shop/lv12.png" />
<meta name="google-adsense-account" content="ca-pub-7770714931220768">
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7770714931220768"
     crossorigin="anonymous"></script>
<meta property="og:title" content="متجر LV12 - تسوق ذكي وسريع" />
<meta property="og:description" content="أفضل تجربة تسوق عبر الإنترنت - منتجات مميزة وشحن سريع لجميع المحافظات." />
<meta property="og:image" content="https://www.lv12shop.shop/lv12.png" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://www.lv12shop.shop" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="متجر LV12 - تسوق ذكي وسريع" />
<meta name="twitter:description" content="أفضل تجربة تسوق عبر الإنترنت - منتجات مميزة وشحن سريع لجميع المحافظات." />
<meta name="twitter:image" content="https://www.lv12shop.shop/lv12.png" />

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Organization",
  "name": "LV12 Shop",
  "url": "https://www.lv12shop.shop",
  "logo": "https://www.lv12shop.shop/lv12.png"
}
</script>

<link rel="icon" href="lv12.ico">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;600;700&display=swap">

<style>
body {
  margin: 0;
  padding: 0;
  background: #ffffff;
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
  overflow: hidden;
  font-family: "Tajawal", sans-serif;
}

.logo {
  width: 130px;
  animation: fadeIn 0.5s ease-out forwards, pop 0.8s ease-out 0.1s forwards;
}

@keyframes fadeIn {
  from { opacity: 0; transform: scale(0.85); }
  to { opacity: 1; transform: scale(1); }
}

@keyframes pop {
  0% { transform: scale(1); }
  60% { transform: scale(1.15); }
  100% { transform: scale(1); }
}
</style>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebSite",
  "name": "LV12 Shop",
  "url": "https://lv12shop.shop",
  "potentialAction": {
    "@type": "SearchAction",
    "target": "https://lv12shop.shop/shop.html?search={search_term}",
    "query-input": "required name=search_term"
  }
}
</script>

</head>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebSite",
  "name": "LV12 Shop",
  "url": "https://lv12shop.shop",
  "potentialAction": {
    "@type": "SearchAction",
    "target": "https://lv12shop.shop/shop.html?search={search_term}",
    "query-input": "required name=search_term"
  }
}
</script>

<body>

<img src="lv12.png" alt="LV12 Shop" class="logo">

<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-messaging-compat.js"></script>
<script src="https://unpkg.com/@supabase/supabase-js@2"></script>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script src="supabase-config.js"></script>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyDXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX",
  authDomain: "your-project.firebaseapp.com",
  projectId: "your-project-id",
  storageBucket: "your-project.appspot.com",
  messagingSenderId: "123456789012",
  appId: "1:123456789012:web:abcdefghijklmnop"
};

firebase.initializeApp(firebaseConfig);


function sendNotification(title, body) {
  if (Notification.permission === 'granted') {
    const notification = new Notification(title, {
      body: body,
      icon: '/lv12.jpg',
      badge: '/lv12.jpg',
      requireInteraction: true
    });
    
    notification.onclick = () => {
      window.focus();
      notification.close();
    };
  }
}

async function initNotifications() {
  if ('Notification' in window) {
    const permission = await Notification.requestPermission();
    if (permission === 'granted') {
      console.log('Notifications enabled');
      
      setTimeout(() => {
        sendNotification('مرحباً بك في LV12 Shop', 'تم تفعيل الإشعارات بنجاح!');
      }, 2000);
      
      setInterval(checkForUpdates, 30000);
    }
  }
}

async function checkForUpdates() {
  try {
    const user = JSON.parse(localStorage.getItem('lv12_user') || '{}');
    if (user.id) {
      const { data: orders } = await supabase
        .from('orders')
        .select('*')
        .eq('user_id', user.id)
        .order('created_at', { ascending: false })
        .limit(1);
      
      if (orders && orders.length > 0) {
        const lastCheck = localStorage.getItem('last_order_check');
        const orderTime = new Date(orders[0].created_at).getTime();
        
        if (!lastCheck || orderTime > parseInt(lastCheck)) {
          sendNotification('طلب جديد!', `تم استلام طلبك رقم ${orders[0].id}`);
          localStorage.setItem('last_order_check', Date.now().toString());
        }
      }
    }
  } catch (error) {
    console.log('Update check failed:', error);
  }
}

function showNotification(payload) {
  const title = payload.notification?.title || 'إشعار جديد';
  const body = payload.notification?.body || 'لديك رسالة جديدة';
  
  if (Notification.permission === 'granted') {
    new Notification(title, {
      body: body,
      icon: '/lv12.jpg',
      badge: '/lv12.jpg',
      tag: 'lv12-notification'
    });
  }
}

const linksToPreload = [
  "shop.html",
  "product.html",
  "cart.html",
  "my-orders.html",
  "wallet.html"
];

linksToPreload.forEach(url => fetch(url).catch(()=>{}));

initNotifications();

async function logUserActivity(type) {
  const user = JSON.parse(localStorage.getItem('lv12_user') || '{}');
  await supabase.from('user_activity').insert({
    user_id: user.id || null,
    user_display: user.name || 'زائر',
    type
  });
}

logUserActivity('زيارة المتجر');

setTimeout(() => {
  window.location.href = "shop.html";
}, 700);

</script>

</body>
</html>
